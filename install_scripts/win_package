mkdir ./nymph-game-engine-$VERSION-b$TRAVIS_BUILD_NUMBER-win/
mv *.exe ./nymph-game-engine-$VERSION-b$TRAVIS_BUILD_NUMBER-win/

tar -zcvf nymph-game-engine-$VERSION-b$TRAVIS_BUILD_NUMBER-win.tar.gz nymph-game-engine-$VERSION-b$TRAVIS_BUILD_NUMBER-win

#Push off Build Artifacts to git build repo (git-lfs)
git clone $BUILD_REPO
   #Oauth
echo -e "machine github.com\n  login $GITHUB_TOKEN" >> ~/.netrc
cd $BUILD_REPO_NAME
git lfs pull
#Checkout to appropriate OS
git checkout win
#Find current number of builds in this branch
export NUMBER_OF_BUILDS=`gfind . -mindepth 1 -type f -name "*.tar.gz" -printf x | wc -c`
#Remove old builds over the amount allowed plus one for the new build
if [ $NUMBER_OF_BUILDS >= $BUILDS_TO_KEEP ]
then
  gfind . -name '*.dmg' -type f -print0 | xargs -0 ls -tr | head -n $(echo "if($NUMBER_OF_BUILDS-$BUILDS_TO_KEEP+1<0) 0 else $NUMBER_OF_BUILDS-$BUILDS_TO_KEEP+1" | bc) | xargs rm
fi
mv ../nymph-game-engine-$VERSION-b$TRAVIS_BUILD_NUMBER-win.tar.gz .
git add nymph-game-engine-$VERSION-b$TRAVIS_BUILD_NUMBER-win.tar.gz
git commit -m "Build success for win, version $VERSION, build $TRAVIS_BUILD_NUMBER."
git push origin win
